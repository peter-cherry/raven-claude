"use client";

import Link from 'next/link';
import { usePathname } from 'next/navigation';

function IconSearch() {
  return (
    <svg width="20" height="20" viewBox="20 168 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <clipPath id="cp-search">
          <path d="M31 172C27.6863 172 25 174.686 25 178C25 181.314 27.6863 184 31 184C34.3137 184 37 181.314 37 178C37 174.686 34.3137 172 31 172ZM23 178C23 173.582 26.5817 170 31 170C35.4183 170 39 173.582 39 178C39 179.849 38.3729 181.551 37.3199 182.906L42.7071 188.293C43.0976 188.683 43.0976 189.317 42.7071 189.707C42.3166 190.098 41.6834 190.098 41.2929 189.707L35.9056 184.32C34.551 185.373 32.8487 186 31 186C26.5817 186 23 182.418 23 178Z"/>
        </clipPath>
      </defs>
      <path d="M31 172C27.6863 172 25 174.686 25 178C25 181.314 27.6863 184 31 184C34.3137 184 37 181.314 37 178C37 174.686 34.3137 172 31 172ZM23 178C23 173.582 26.5817 170 31 170C35.4183 170 39 173.582 39 178C39 179.849 38.3729 181.551 37.3199 182.906L42.7071 188.293C43.0976 188.683 43.0976 189.317 42.7071 189.707C42.3166 190.098 41.6834 190.098 41.2929 189.707L35.9056 184.32C34.551 185.373 32.8487 186 31 186C26.5817 186 23 182.418 23 178Z" fill="currentColor"/>
      <g clipPath="url(#cp-search)" className="icon-glow">
        <rect x="20" y="168" width="24" height="24" className="glow-fill" />
      </g>
    </svg>
  );
}
function IconList() {
  return (
    <svg width="20" height="20" viewBox="20 344 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <clipPath id="cp-list">
          <path d="M21 348.996C21 347.894 21.8954 347 23 347H33C34.1046 347 35 347.894 35 348.996V352.989H39C40.1046 352.989 41 353.883 41 354.985V364.967C41 366.069 40.1046 366.963 39 366.963H29C27.8954 366.963 27 366.069 27 364.967V360.974H23C21.8954 360.974 21 360.08 21 358.978V348.996ZM29 360.974V364.967H39V354.985H35V358.978C35 360.08 34.1046 360.974 33 360.974H29ZM33 358.978V348.996L23 348.996V358.978H33Z"/>
        </clipPath>
      </defs>
      <path d="M21 348.996C21 347.894 21.8954 347 23 347H33C34.1046 347 35 347.894 35 348.996V352.989H39C40.1046 352.989 41 353.883 41 354.985V364.967C41 366.069 40.1046 366.963 39 366.963H29C27.8954 366.963 27 366.069 27 364.967V360.974H23C21.8954 360.974 21 360.08 21 358.978V348.996ZM29 360.974V364.967H39V354.985H35V358.978C35 360.08 34.1046 360.974 33 360.974H29ZM33 358.978V348.996L23 348.996V358.978H33Z" fill="currentColor"/>
      <g clipPath="url(#cp-list)" className="icon-glow">
        <rect x="20" y="344" width="24" height="24" className="glow-fill" />
      </g>
    </svg>
  );
}
function IconAvatar() {
  return (
    <svg width="20" height="20" viewBox="22 288 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <clipPath id="cp-avatar">
          <path d="M29.2 291.797C27.2118 291.797 25.6 293.405 25.6 295.39C25.6 297.375 27.2118 298.983 29.2 298.983C31.1882 298.983 32.8 297.375 32.8 295.39C32.8 293.405 31.1882 291.797 29.2 291.797ZM23.8 295.39C23.8 292.413 26.2177 290 29.2 290C32.1823 290 34.6 292.413 34.6 295.39C34.6 298.367 32.1823 300.78 29.2 300.78C26.2177 300.78 23.8 298.367 23.8 295.39ZM35.3456 291.579C35.6971 291.228 36.2669 291.228 36.6184 291.579C38.7272 293.684 38.7272 297.096 36.6184 299.201C36.2669 299.552 35.6971 299.552 35.3456 299.201C34.9941 298.85 34.9941 298.282 35.3456 297.931C36.7515 296.528 36.7515 294.252 35.3456 292.849C34.9941 292.498 34.9941 291.93 35.3456 291.579ZM35.9769 303.257C36.0974 302.776 36.5861 302.483 37.0683 302.603C38.2634 302.902 39.0199 303.664 39.455 304.533C39.876 305.373 40 306.311 40 307.068C40 307.564 39.5971 307.967 39.1 307.967C38.6029 307.967 38.2 307.564 38.2 307.068C38.2 306.478 38.099 305.844 37.845 305.337C37.6051 304.858 37.2366 304.497 36.6317 304.347C36.1495 304.226 35.8563 303.738 35.9769 303.257ZM26.05 304.373C24.9165 304.373 23.8 305.463 23.8 307.068C23.8 307.564 23.3971 307.967 22.9 307.967C22.4029 307.967 22 307.564 22 307.068C22 304.704 23.7041 302.577 26.05 302.577H32.35C34.6959 302.577 36.4 304.704 36.4 307.068C36.4 307.564 35.9971 307.967 35.5 307.967C35.0029 307.967 34.6 307.564 34.6 307.068C34.6 305.463 33.4835 304.373 32.35 304.373H26.05Z"/>
        </clipPath>
      </defs>
      <path d="M29.2 291.797C27.2118 291.797 25.6 293.405 25.6 295.39C25.6 297.375 27.2118 298.983 29.2 298.983C31.1882 298.983 32.8 297.375 32.8 295.39C32.8 293.405 31.1882 291.797 29.2 291.797ZM23.8 295.39C23.8 292.413 26.2177 290 29.2 290C32.1823 290 34.6 292.413 34.6 295.39C34.6 298.367 32.1823 300.78 29.2 300.78C26.2177 300.78 23.8 298.367 23.8 295.39ZM35.3456 291.579C35.6971 291.228 36.2669 291.228 36.6184 291.579C38.7272 293.684 38.7272 297.096 36.6184 299.201C36.2669 299.552 35.6971 299.552 35.3456 299.201C34.9941 298.85 34.9941 298.282 35.3456 297.931C36.7515 296.528 36.7515 294.252 35.3456 292.849C34.9941 292.498 34.9941 291.93 35.3456 291.579ZM35.9769 303.257C36.0974 302.776 36.5861 302.483 37.0683 302.603C38.2634 302.902 39.0199 303.664 39.455 304.533C39.876 305.373 40 306.311 40 307.068C40 307.564 39.5971 307.967 39.1 307.967C38.6029 307.967 38.2 307.564 38.2 307.068C38.2 306.478 38.099 305.844 37.845 305.337C37.6051 304.858 37.2366 304.497 36.6317 304.347C36.1495 304.226 35.8563 303.738 35.9769 303.257ZM26.05 304.373C24.9165 304.373 23.8 305.463 23.8 307.068C23.8 307.564 23.3971 307.967 22.9 307.967C22.4029 307.967 22 307.564 22 307.068C22 304.704 23.7041 302.577 26.05 302.577H32.35C34.6959 302.577 36.4 304.704 36.4 307.068C36.4 307.564 35.9971 307.967 35.5 307.967C35.0029 307.967 34.6 307.564 34.6 307.068C34.6 305.463 33.4835 304.373 32.35 304.373H26.05Z" fill="currentColor"/>
      <g clipPath="url(#cp-avatar)" className="icon-glow">
        <rect x="22" y="288" width="24" height="24" className="glow-fill" />
      </g>
    </svg>
  );
}
function IconCopy() {
  return (
    <svg width="20" height="20" viewBox="20 228 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <clipPath id="cp-copy">
          <path d="M28 239.5C28.5523 239.5 29 239.052 29 238.5C29 237.948 28.5523 237.5 28 237.5C27.4477 237.5 27 237.948 27 238.5C27 239.052 27.4477 239.5 28 239.5Z"/>
          <path d="M30 238.5C30 237.948 30.4477 237.5 31 237.5H34C34.5523 237.5 35 237.948 35 238.5C35 239.052 34.5523 239.5 34 239.5H31C30.4477 239.5 30 239.052 30 238.5Z"/>
          <path d="M31 240.5C30.4477 240.5 30 240.948 30 241.5C30 242.052 30.4477 242.5 31 242.5H34C34.5523 242.5 35 242.052 35 241.5C35 240.948 34.5523 240.5 34 240.5H31Z"/>
          <path d="M31 243.5C30.4477 243.5 30 243.948 30 244.5C30 245.052 30.4477 245.5 31 245.5H34C34.5523 245.5 35 245.052 35 244.5C35 243.948 34.5523 243.5 34 243.5H31Z"/>
          <path d="M29 241.5C29 242.052 28.5523 242.5 28 242.5C27.4477 242.5 27 242.052 27 241.5C27 240.948 27.4477 240.5 28 240.5C28.5523 240.5 29 240.948 29 241.5Z"/>
          <path d="M28 245.5C28.5523 245.5 29 245.052 29 244.5C29 243.948 28.5523 243.5 28 243.5C27.4477 243.5 27 243.948 27 244.5C27 245.052 27.4477 245.5 28 245.5Z"/>
          <path d="M28 230C27.4477 230 27 230.448 27 231H25C23.8954 231 23 231.895 23 233V248C23 249.105 23.8954 250 25 250H37C38.1046 250 39 249.105 39 248V233C39 231.895 38.1046 231 37 231H35C35 230.448 34.5523 230 34 230H28ZM35 233H37V248H25V233H27V234C27 234.552 27.4477 235 28 235H34C34.5523 235 35 234.552 35 234V233ZM29 233V232H33V233H29Z"/>
        </clipPath>
      </defs>
      <g fill="currentColor">
        <path d="M28 239.5C28.5523 239.5 29 239.052 29 238.5C29 237.948 28.5523 237.5 28 237.5C27.4477 237.5 27 237.948 27 238.5C27 239.052 27.4477 239.5 28 239.5Z"/>
        <path d="M30 238.5C30 237.948 30.4477 237.5 31 237.5H34C34.5523 237.5 35 237.948 35 238.5C35 239.052 34.5523 239.5 34 239.5H31C30.4477 239.5 30 239.052 30 238.5Z"/>
        <path d="M31 240.5C30.4477 240.5 30 240.948 30 241.5C30 242.052 30.4477 242.5 31 242.5H34C34.5523 242.5 35 242.052 35 241.5C35 240.948 34.5523 240.5 34 240.5H31Z"/>
        <path d="M31 243.5C30.4477 243.5 30 243.948 30 244.5C30 245.052 30.4477 245.5 31 245.5H34C34.5523 245.5 35 245.052 35 244.5C35 243.948 34.5523 243.5 34 243.5H31Z"/>
        <path d="M29 241.5C29 242.052 28.5523 242.5 28 242.5C27.4477 242.5 27 242.052 27 241.5C27 240.948 27.4477 240.5 28 240.5C28.5523 240.5 29 240.948 29 241.5Z"/>
        <path d="M28 245.5C28.5523 245.5 29 245.052 29 244.5C29 243.948 28.5523 243.5 28 243.5C27.4477 243.5 27 243.948 27 244.5C27 245.052 27.4477 245.5 28 245.5Z"/>
        <path d="M28 230C27.4477 230 27 230.448 27 231H25C23.8954 231 23 231.895 23 233V248C23 249.105 23.8954 250 25 250H37C38.1046 250 39 249.105 39 248V233C39 231.895 38.1046 231 37 231H35C35 230.448 34.5523 230 34 230H28ZM35 233H37V248H25V233H27V234C27 234.552 27.4477 235 28 235H34C34.5523 235 35 234.552 35 234V233ZM29 233V232H33V233H29Z"/>
      </g>
      <g clipPath="url(#cp-copy)" className="icon-glow">
        <rect x="20" y="228" width="24" height="24" className="glow-fill" />
      </g>
    </svg>
  );
}
function IconSettings() {
  return (
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z" stroke="currentColor" strokeWidth="2"/>
      <path d="M19.4 15a1 1 0 0 0 .2 1.1l.1.1a2 2 0 1 1-2.8 2.8l-.1-.1a1 1 0 0 0-1.1-.2 1 1 0 0 0-.6.9V20a2 2 0 1 1-4 0v-.1a1 1 0 0 0-.7-.9 1 1 0 0 0-1.1.2l-.1.1a2 2 0 1 1-2.8-2.8l.1-.1a1 1 0 0 0 .2-1.1 1 1 0 0 0-.9-.6H4a2 2 0 1 1 0-4h.1a1 1 0 0 0 .9-.7 1 1 0 0 0-.2-1.1l-.1-.1A2 2 0 1 1 7.5 4.7l.1.1a1 1 0 0 0 1.1.2h.1a1 1 0 0 0 .6-.9V4a2 2 0 1 1 4 0v.1a1 1 0 0 0 .7.9h.1a1 1 0 0 0 1.1-.2l.1-.1A2 2 0 1 1 20 7.6l-.1.1a1 1 0 0 0-.2 1.1v.1a1 1 0 0 0 .9.6H20a2 2 0 1 1 0 4h-.1a1 1 0 0 0-.9.6Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
    </svg>
  );
}

const navItems = [
  { href: '/', Icon: IconSearch, label: 'Home' },
  { href: '/jobs', Icon: IconList, label: 'Jobs' },
  { href: '/technicians', Icon: IconAvatar, label: 'Technicians' },
  { href: '/compliance#frame-6', Icon: IconCopy, label: 'Compliance' },
];

export function Sidebar() {
  const pathname = usePathname();

  return (
    <aside className="sidebar hover-expand">
      <svg className="sidebar-svg-bg" width="85" height="1128" viewBox="0 0 85 1128" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
        <rect x="0" y="0" width="85" height="1128" fill="#151413"/>
        <rect x="1" y="1" width="83" height="1126" stroke="#201939" strokeWidth="2" fill="none"/>
      </svg>

      <nav className="nav-stack">
        {navItems.map(({ href, Icon, label }) => {
          const roleClass = href === '/'
            ? 'nav-home'
            : href.startsWith('/jobs')
            ? 'nav-jobs'
            : href.startsWith('/technicians')
            ? 'nav-tech'
            : href.startsWith('/compliance')
            ? 'nav-compliance'
            : '';
          return (
            <Link
              key={href}
              href={href}
              className={`nav-item ${roleClass} ${pathname.startsWith(href.replace(/#.*/,'')) ? 'active' : ''}`}
              aria-label={label}
              title={label}
            >
              <span className="nav-icon" aria-hidden><Icon /></span>
            </Link>
          );
        })}
      </nav>

      <div className="bottom-push">
        <Link href="/settings" className="nav-item" aria-label="Settings" title="Settings">
          <span className="nav-icon" aria-hidden><IconSettings /></span>
        </Link>
      </div>
    </aside>
  );
}
